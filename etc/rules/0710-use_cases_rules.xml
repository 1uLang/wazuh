<!-- Use cases rules -->

<!-- Modify it at your will. -->
<!-- Copyright (C) 2015-2020, Wazuh Inc. -->

<!-- netcat -->
<group name="ossec,">
    <rule id="100050" level="0">
        <if_sid>530</if_sid>
        <match>^ossec: output: 'process list'</match>
        <description>List of running processes.</description>
        <group>process_monitor,</group>
    </rule>

    <rule id="100051" level="7" ignore="900">
        <if_sid>100050</if_sid>
        <group>process_monitor,</group>
        <field name="command">^\.*/nc \.*-l|^nc \.*-l</field>
        <description>Netcat listening for incoming connections.</description>
    </rule>
</group>

<!-- Yara -->
<group name="yara,">
    <rule id="108000" level="0">
        <decoded_as>yara-decoder</decoded_as>
        <description>Yara grouping rule</description>
    </rule>

    <rule id="108001" level="12">
        <if_sid>108000</if_sid>
        <match>wazuh-yara: INFO - Scan result: </match>
        <description>File "$(yara_scanned_file)" is a positive match. Yara rule: $(yara_rule)</description>
    </rule>
</group>
