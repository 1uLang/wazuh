# Security Configuration Assessment
# CIS Checks for HPUX 11i
# Copyright (C) 2015-2021, Wazuh Inc.
#
# This program is free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
#
# Based on:
# Center for Internet Security Benchmark for HP-UX 11i from 09-17-2009

policy:
  id: "cis_hpux"
  file: "cis_hpux_11i.yml"
  name: "CIS HP-UX 11i Benchmark"
  description: "This document provides prescriptive guidance for establishing a secure configuration posture for HPUX version 11i. This guide was tested against HPUX"
  references:
    - https://www.cisecurity.org/cis-benchmarks/

requirements:
  title: "Check HPUX version"
  description: "Requirements for running the SCA scan against HPUX family."
  condition: any
  rules:
    - 'c:swlist HPUX*OE* -> r:^HPUX11i'

checks:

#################################################################
# 1.1  Install patches and supplementary software
#################################################################

  - id: 21000
    title: "Apply the latest OS patches"
    description: "Install the most current HP-UX patches and establish procedures for keeping up with future patches using HP-UX Software Assistant and HP Security Bulletin service."
    rationale: "Installing up-to-date vendor patches and developing a procedure for keeping up with vendor patches is critical for the security and reliability of the system.  Vendors will issue operating system updates when they become aware of security vulnerabilities and other serious functionality issues, but it is up to their customers to actually download and install these patches."
    remediation: "Download and install HP-UX Software Assistant from https://www.hp.com/go/swa if not already installed on the system. Follow the installation instructions available the above page. Run Software Assistant (SWA) as: Perform the actions specified by Software Assistant."
    compliance:
      - cis: ["1.1.1"]
      - cis_level: ["1"]
    references:
      - https://www.hp.com/go/swa
      - http://itrc.hp.com/service/patch/releaseIndexPage.do
      - http://itrc.hp.com/
    condition: all
    rules:


  - id: 21001
    title: "Install and configure HP-UX Secure Shell"
    description: "OpenSSH is a popular free distribution of the standards-track SSH protocols  which allows secure encrypted network logins and file transfers.   HP-UX Secure Shell is HP’s pre-compiled and supported version of OpenSSH."
    rationale: "Common login and file transfer services such as telnet, FTP, rsh, rlogin, and rcp use insecure, clear-text protocols that are vulnerable to attack.  OpenSSH provides a secure, encrypted replacement for these services.   Security is improved by further constraining services in the default configuration. "
    remediation: "Perform the following to install and securely configure Secure Shell (SSH) 1. Download and install HP-UX Secure Shell if not already installed on the system.  2. Perform the following post-installation actions to secure the SSH service: a. Change to the /opt/ssh/etc directory b. Open sshd_config c. Set the Protocol token to 2.  If it is absent, add and set it. d. Set the X11Forwarding token to yes.  If it is absent, add and set it. e. Set the IgnoreRhosts token to yes.  If itis absent, add and set it. f. Set the RhostsAuthentication token to no.  If it is absent, add and set it. g. Set the RhostsRSAAuthentication token to no. If it is absent, add and set it. h. Set the PermitRootLogin token to no. If it is absent, add and set it. i. Set the PermitEmptyPasswords token to no. If it is absent, add and set it. j. Set the Banner token to /etc/issue. If it is absent, add and set it. k. Set root as the owner of sshd_config and ssh_config. l. Set sys as the groupowner of sshd_config and ssh_config. m.  Restrict write access to sshd_config and ssh_config to the file owner."
    compliance:
      - cis: ["1.1.2"]
      - cis_level: ["1"]
    references:
      - http://www.openssh.org/
      - http://h20392.www2.hp.com/portal/swdepot/displayProductInfo.do?productNumber=T1471AA
    condition: all
    rules:
      -

  - id: 21002
    title: "Use Bastille to report security configuration state"
    description: "Bastille is a security hardening, lockdown tool supplied with HP-UX to assist administrators in securing their systems.  Included is an assessment function that covers a wide range of lockdown items including most all items in this Benchmark.   Bastille can serve as a reporting and audit tool.   Appendix D provides a mapping of Benchmark items to related Bastille configuration items."
    rationale: "An automated, tested, and vendor supported reporting tool such as Bastille is more efficient and less error-prone than most manual or custom scripted methods."
    remediation: "Run Bastille to create an assessment report as shown: /opt/sec_mgmt/bastille/bin/bastille --assessnobrowser"
    compliance:
      - cis: ["1.1.3"]
    references:
      - https://www.hp.com/go/bastille
    condition: all
    rules:
      -

#################################################################
# 1.2 Minimize inetd network services
#################################################################



  - id: 21003
    title: "Disable Standard Services"
    description: "The stock /etc/inetd.conf file shipped with HP-UX contains many services which are rarely used, or which have more secure alternatives. Indeed, after enabling SSH (see item 1.1.2) it may be possible to completely do away with all inetd-based services, since SSH provides both a secure login mechanism and a means of transferring files to and from the system.  The steps articulated in the Remediation section will disable all services normally enabled in the HP-UX inetd.conf file."
    rationale: "The stock /etc/inetd.conf file shipped with HP-UX contains services that are rarely used or have more secure alternatives.  Removing these from inetd will avoid exposure to possible security vulnerability in those services."
    remediation: "Perform the following to disable standard inetd-based services: 1. Change to the /etc directory 2. Open inetd.conf 3. Disable the following services by adding a comment character (#) to the beginning of its definition:   a.  echo b.  discard c.  daytime d.  chargen e.  dtspc f.  exec g.  ntalk q.  rpc.rwalld r.  rpc.sprayd s.  rpc.cmsd t.  kcms_server u.  printer v.  shell w.  login h.  finger i.  uucp j.  ident k.  auth l.  instl_boots m.  registrar n.  recserv o.  rpc.rstatd p.  rpc.rusersd  x.  telnet y.  ftp z.  tftp aa.  bootps bb.  kshell cc.  klogin dd.  rpc.rquotad ee.  rpc.ttdbserver 4. Save inetd.conf.  5. Set root as the owner of inetd.conf. 6. Set sys as the group owner of inetd.conf. 7. Restrict write access to inetd.conf to the file owner. 8. Remove the executable and sticky bit from inetd.conf. 9. Invoke inetd to reread it’s config file: inetd -c "
    compliance:
      - cis: ["1.2.1"]
      - cis_level: ["1"]
    references:
      - http://docs.hp.com/en/B2355-60130/inetd.conf.4.html
    condition: all
    rules:
      -

  - id: 21004
    title: "Only enable telnet if absolutely necessary"
    description: "Re-enable telnet. Telnet uses an unencrypted network protocol, which means data from the login session (such as passwords and all other data transmitted during the session) can be stolen by eavesdroppers on the network, and also that the session can be hijacked by outsiders to gain access to the remote system.  HP-UX Secure Shell (OpenSSH) provides an encrypted alternative to telnet (and other utilities) and should be used instead."
    rationale: "There is a mission-critical reason that requires users to access the system via telnet instead of the more secure SSH protocol."
    remediation: "Perform the following to re-enable telnet: 1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the telnet service definition. 3. Add –b /etc/issue to the end of the telnet service definition. This will cause telnet to display the contents of /etc/issue to users attempting to access the system via telnet. 4. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.2"]
    condition: all
    rules:
      -

  - id: 21005
    title: "Only enable FTP if absolutely necessary"
    description: "Re-enable ftp. Like telnet, the FTP protocol is unencrypted, which means passwords and other data transmitted during the session can be captured by sniffing the network, and that the FTP session itself can be hijacked by an external attacker. SSH provides two alternative, encrypted file transfer mechanisms, scp and sftp, which should be used instead of FTP.  Even if FTP is required because the local system is an anonymous FTP server, consider requiring authenticated users onthe system to transfer files via SSH-based protocols.  For further information on restricting FTP access to the system, see item 1.6.2.  Sites may also consider augmenting the “ftpd -l” below with '-v' (10.x and 11.x) or '-L' (11.x only) for additional logging of FTP transactions, or with '-a' (11.x only) for fine grain FTP access control through the use of a configuration file – see the ftpd(1M) man page on your systems for details."
    rationale: "This machine serves as an (anonymous) FTP server or other mission-critical role where data must be transferred via FTP instead of the more secure alternatives."
    remediation: "Perform the following to re-enable FTP:  1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the ftp service definition. 3. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.3"]
    condition: all
    rules:
      -

  - id: 21006
    title: "Only enable rlogin/remsh/rcp if absolutely necessary"
    description: "SSH was designed to be a drop-in replacement for these protocols.  Given the wide availability of free SSH implementations, there are few cases where these tools cannot be replaced with SSH (again, see item 1.2.1 – Install SSH)."
    rationale: "There is a mission-critical reason to use rlogin/remsh/rcp instead of the more secure ssh/scp."
    remediation: "Perform the following to re-enable rlogin/remsh/rcp: 1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the shell and login service definitions. 3. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.4"]
    condition: all
    rules:
      -

  - id: 21007
    title: "Only enable TFTP if absolutely necessary"
    description: "TFTP is typically used for network booting of diskless workstations, X-terminals, and other similar devices.  TFTP is also used during network installs of systems via the HP-UX Ignite facility.  Routers and other network devices may copy configuration data to remote systems via TFTP for backup"
    rationale: "This system serves as a boot server or has other mission-critical roles where data must be transferred to and from this system via TFTP."
    remediation: "Perform the following to re-enable TFTP: 1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the tftp service definition. 3. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.5"]
    condition: all
    rules:
      -
  - id: 21008
    title: "Only enable printer service if absolutely necessary"
    description: "rlpdaemon provides a BSD-compatible print server interface.  Even machines that are print servers may wish to leave this service disabled if they do not need to support BSD-style printing."
    rationale: "This machine a print server for your network."
    remediation: "Perform the following to re-enable the rlpdaemon based printer service:  1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the printer definition. 3. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.6"]
    condition: all
    rules:
      -

  - id: 21009
    title: "Only enable rquotad if absolutely necessary"
    description: "rquotad allows NFS clients to enforce disk quotas on file systems that are mounted from the local system.  If your site does not use disk quotas, then you may leave the rquotad service disabled."
    rationale: "This system an NFS file server that requires the use of disk quotas"
    remediation: "Perform the following to re-enable rquotad: 1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the rquotad definition. 3. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.7"]
    condition: all
    rules:
      -

  - id: 21010
    title: "Only enable CDE-related daemons if absolutely necessary"
    description: "The rpc.ttdbserver service supports HP's CDE windowing environment.  This service has a history of security problems.  Not only is it vital to keep up to date on vendor patches, but also never enable this service on any system which is not well protected by a complete network security infrastructure (including network and host-based firewalls, packet filters, and intrusion detection infrastructure).  Note that since this service uses ONC RPC mechanisms, it is important that the system's RPC portmapper (rpcbind) also be enabled when this service is turned on."
    rationale: "There a mission-critical reason to run a CDE GUI on this system."
    remediation: "Perform the following to re-enable CDE-related daemons: 1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the rpc.ttdbserver definition. 3. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.8"]
    condition: all
    rules:
      -

  - id: 21011
    title: "Only enable Kerberos-related daemons if absolutely necessary"
    description: "Kerberized rlogin/remsh offers a higher degree of security than traditional rlogin, remsh, or telnet by eliminating many clear-text password exchanges from the network.  However it is still not as secure as SSH, which encrypts all traffic.  Given the wide availability of free SSH implementations, there are few cases where these tools cannot be replaced with SSH."
    rationale: "The Kerberos security system is in use at this site and there is a mission-critical reason that requires users to access this system via Kerberized rlogin/remsh, rather than the more secure SSH protocol"
    remediation: "Perform the following to re-enable Kerberos-related daemons:  1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the klogin definition. 3. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.9"]
    condition: all
    rules:
      -

  - id: 21012
    title: "Only enable BOOTP/DHCP daemon if absolutely necessary"
    description: "BOOTP/DHCP is a popular protocol for dynamically assigning IP addresses and other network information to systems on the network (rather than having administrators manually manage this information on each host).  However, if this system is not a BOOTP/DHCP server for the network, there is no need to be running this service"
    rationale: "This server a BOOTP/DHCP server for the network"
    remediation: "Perform the following to re-enable BOOTP/DHCP services:  1. Open /etc/inetd.conf. 2. Delete the comment character (#) from the bootps definition. 3. Save /etc/inetd.conf."
    compliance:
      - cis: ["1.2.10"]
    condition: all
    rules:
      -

#################################################################
# 1.3 Minimize boot services
#################################################################

  - id: 21013
    title: "Disable login: prompts on serial ports"
    description: "Disable the login: prompt on the system serial devices to make it more difficult for unauthorized users to attach modems, terminals, and other remote access devices to these ports."
    rationale: "If there is not a mission-critical need to provide login capability from any serial ports (such as for a modem) then disabling the login: prompt on the system serial devices reduces the risk of unauthorized access via these ports."
    remediation: "Perform the following to disable the login: prompt on the system serial devices:  1. Open /etc/inittab. 2. Disable each getty instance associated with a tty device by adding a comment character (#) to the beginning of the line. 3. Save /etc/inittab.*"
    compliance:
      - cis: ["1.3.1"]
      - cis_level: ["1"]
    condition: all
    rules:
      -

  - id: 21014
    title: "Disable NIS/NIS+ related processes, if possible"
    description: "Disable NIS/NIS+ related processes. Network Information Service (NIS) is a distributed database providing centralized control of names, addresses, services, and key configuration files throughout a network of servers and clients.  NIS was formerly known as Yellow Pages (YP).  NIS+ is a replacement for NIS services, and is more scalable, flexible, and secure.  It adds a security system with authentication and authorization services to validate users on the network and todetermine if they allowed to access or modify the information requested.  However, both systems have known security vulnerabilities, and have been an entry point for security attacks."
    rationale: "Eliminate exposure to NIS/NIS+ vulnerabilities by not running related daemons on hosts that are not NIS/NIS+ servers or clients."
    remediation: "Perform the following to disable the startup of NIS/NIS+ related processes: ch_rc -a -p NIS_MASTER_SERVER=0 -p NIS_SLAVE_SERVER=0 \   -p NIS_CLIENT=0 -p NISPLUS_SERVER=0 \   -p NISPLUS_CLIENT=0 /etc/rc.config.d/namesvrs"
    compliance:
      - cis: ["1.3.2"]
      - cis_level: ["1"]
    condition: all
    rules:
      -

  - id: 21015
    title: "Disable printer daemons, if possible"
    description: "Disable printer daemons. The Technical Print Service (TPS) is a printer service used in the X-Windows and/or CDE environment.  It is recommended that this service be disabled if the hosting system does not participate in print services The administrator may wish to consider converting to the LPRng print system (see http://www.lprng.org/) which was designed with security in mind and is widely portable across many different Unix platforms.  Note, however, that LPRng is notsupported by Hewlett-Packard."
    rationale: "Disabling unused services, such as TPS, will reduce the remote and local attack surfaces of the hosting system."
    remediation: "Perform the following to disable printer daemons: 1. Set the LP parameter to zero in the lp system configuration file /etc/rc.config.d/lp 2. Set the XPRINTSERVERS parameter to an empty string in the tps system configuration file /etc/rc.config.d/tps"
    compliance:
      - cis: ["1.3.3"]
      - cis_level: ["1"]
    condition: all
    rules:
      -

  - id: 21016
    title: "Disable the CDE GUI login, if possible"
    description: "CDE stands for "Common Desktop Environment," and is an environment for logging on to and interacting with your system via an X-windows type GUI interface from the console. Intended for use with workstation or desktop systems, this service is not commonly used with the server-class systems or in large enterprise environments.  The X Windows-based CDE GUI services were developed with a different set of security expecations from those expected in many enterprise deployments, and have had a history of security issues.  Unless there is a mission-critical need for a CDE GUI login to the system, this service should not be run to further reduce opportunities for security attacks."
    rationale: "The X Windows-based CDE GUI on HP-UX systems has had a history of security issues, and should be disabled if unused."
    remediation: "Perform the following to disable the GUI login: ch_rc -a -p DESKTOP="" /etc/rc.config.d/desktop"
    compliance:
      - cis: ["1.3.4"]
      - cis_level: ["1"]
    condition: all
    rules:
      -

  - id: 21017
    title: "Disable email server, if possible"
    description: "Disable the sendmail daemon to avoid processing incoming email.  It is possible to run a Unix system with the Sendmail daemon disabled and still allow users on that system to send email out from that machine.  Running Sendmail in daemon mode (with the -bd command-line option) is only required on machines that act as mail servers, receiving and processing email from other hosts on the network.  The remediation below will result in a machine that can send email but not receiveit.  Note that after disabling the –bd option on the local mail server on systems running Sendmail v8.12 or later (8.13 is currently shipped as part of HP-UX 11iv3), it is also necessary to modify the /etc/mail/submit.cf file.  Find the line that reads 'D{MTAHost}localhost' and change localhost to the name of some other local mail server for the organization.  This will cause email generated on the local system to be relayed to that mail server for further processing and delivery.  Note that if the system is an email server, the administrator is encouraged to search the Web for additional documentation on Sendmail security issues."
    rationale: "Avoid potential vulnerabilities in the sendmail server if incoming email service is not used."
    remediation: "Perform the following to disable the sendmail server: 1. Set the SENDMAIL_SERVER parameter to zero in the mailservs system configuration file. 2. Setup a cron job to run sendmail at regular intervals (e.g. every hour) in order to process queued, outgoing mail. "
    compliance:
      - cis: ["1.3.5"]
      - cis_level: ["1"]
    references:
      - http://www.deer-run.com/~hal/dns-sendmail/DNSandSendmail.pdf
      - http://www.sendmail.org/
    condition: all
    rules:
      -

  - id: 21018
    title: "Disable SNMP and OpenView Agents, if remote management or monitoring are not needed."
    description: "Disable SNMP and OpenView agents if they are not needed. Note: If SNMP is used, it is recommended to change the default SNMP community string by modifying the get-community and set-community parameters in the SNMP configuration file /etc/SnmpAgent.d/snmpd.conf"
    rationale: "If SNMP and OpenView agents are not needed, avoid potential security vulnerabilities in these programs by disabling them."
    remediation: "Perform the following to disable the SNMP and OpenView Agents:  cd /sbin/rc2.d mv -f S570SnmpFddi .NOS570SnmpFddi      ch_rc -a -p SNMP_HPUNIX_START=0 \   /etc/rc.config.d/SnmpHpunix ch_rc -a -p SNMP_MASTER_START=0 \   /etc/rc.config.d/SnmpMaster ch_rc -a -p SNMP_MIB2_START=0 \  /etc/rc.config.d/SnmpMib2 ch_rc -a -p SNMP_TRAPDEST_START=0 \   /etc/rc.config.d/SnmpTrpDst ch_rc –a –p OSPFMIB=0 \   /etc/rc.config.d/netdaemons ch_rc –a –p OPCAGT=0 \   /etc/rc.config.d/opcagt"
    compliance:
      - cis: ["1.3.6"]
      - cis_level: ["1"]
    condition: all
    rules:
      -

  - id: 21019
    title: "Disable rarely used standard boot services"
    description: "Setting these variables in the /etc/rc.config.d configuration files will effectively disable a wide variety of infrequently used subsystems.  Variables are merely set (rather than renaming or removing startup scripts) so that the local administrator can easily 'restore' any of these services if they discover a mission-critical need to have it.  Additionally, HP-UX patches tend to supply fresh copies of the startup scripts, so they may get inadvertently re-enabled, whereassetting configuration variables usually survives patch installs.  Finally, setting configuration variables is the method recommended and supported by HP. Note that not all of the configuration files listed above will exist on all systems (some are only valid for certain releases, others only exist if certain OEM vendor software is installed). The rest of the actions in this section give the administrator the option of re-enabling certain services – in particular, the services thataredisabled in the second block of the remediation section below.  Rather than disabling and then re-enabling these services, experienced administrators may wish to simply disable only those services that they know are unnecessary for their systems."
    rationale: "Avoid potential security vulnerabilities in infrequently used subsystems by disabling them."
    remediation: "Perform the following:   ch_rc -a -p START_SNAPLUS=0 -p START_SNANODE=0 \   -p START_SNAINETD=0 /etc/rc.config.d/snaplus2 ch_rc -a -p MROUTED=0 -p RWHOD=0 -p DDFA=0 \   -p START_RBOOTD=0 /etc/rc.config.d/netdaemons ch_rc -a -p RARPD=0 -p RDPD=0 /etc/rc.config.d/netconf ch_rc -a -p PTYDAEMON_START=0 /etc/rc.config.d/ptydaemon ch_rc -a -p VTDAEMON_START=0 /etc/rc.config.d/vt ch_rc -a -p NAMED=0 /etc/rc.config.d/namesvrs ch_rc -a -p START_I4LMD=0 /etc/rc.config.d/i4lmd ch_rc -a p RUN_X_FONT_SERVER=0 /etc/rc.config.d/xfs ch_rc -a -p AUDIO_SERVER=0 /etc/rc.config.d/audio ch_rc -a -p SLSD_DAEMON=0 /etc/rc.config.d/slsd ch_rc -a -p RUN_SAMBA=0 /etc/rc.config.d/samba ch_rc -a -p RUN_CIFSCLIENT=0 \   /etc/rc.config.d/cifsclient ch_rc -a -p NFS_SERVER=0 \   -p NFS_CLIENT=0 /etc/rc.config.d/nfsconf ch_rc -a -p HPWS_APACHE_START=0 /etc/rc.config.d/hpws_apacheconf ch_rc –a –p NFS_CORE=0 /etc/rc.config.d/nfsconf"
    compliance:
      - cis: ["1.3.7"]
      - cis_level: ["1"]
    condition: all
    rules:
      -

  - id: 21020
    title: "Only enable Windows-compatibility server processes if absolutely necessary"
    description: "HP-UX 11i includes the popular Open Source Samba server (HP-UX CIFS Server) for providing file and print services to Windows-based systems.  This allows an HP-UX system to act as a file or print server on a Windows network, and even act as a Domain Controller (authentication server) to older Windows operating systems.  However, if this functionality is not required by the site, this service should be disabled."
    rationale: "This machine provides authentication, file sharing, or printer sharing services to systems running Microsoft Windows operating systems."
    remediation: "Perform the following to re-enable CIFS Server: ch_rc -a -p RUN_SAMBA=1 /etc/rc.config.d/samba"
    compliance:
      - cis: ["1.3.8"]
    condition: all
    rules:
      -

  - id: 21021
    title: "Only enable Windows-compatibility client processes if absolutely necessary"
    description: "Re-enable the HP CIFS Client service."
    rationale: "This system requires access to file systems from remote servers via the Windows (SMB) file services."
    remediation: "Perform the following: ch_rc -a -p RUN_CIFSCLIENT=1 /etc/rc.config.d/cifsclient"
    compliance:
      - cis: ["1.3.9"]
    condition: all
    rules:
      -

  - id: 21022
    title: "Only enable NFS server processes if absolutely necessary"
    description: "NFS is frequently exploited to gain unauthorized access to files and systems.  Clearly there is no need to run the NFS server-related daemons on hosts that are not NFS servers. If the system is an NFS server, the admin should take reasonable precautions when exporting file systems, including restricting NFS access to a specific range of local IP addresses and exporting file systems "read-only" and "nosuid" where appropriate.  For more information consult the exportfs(1M) manual page.  Much higher levels of security can be achieved by combining NFS with secure RPC or Kerberos, although there is significant administrative overhead involved in this transition."
    rationale: "This machine is a NFS file server."
    remediation: "Perform the following: ch_rc -a -p NFS_SERVER=1 /etc/rc.config.d/nfsconf"
    compliance:
      - ["1.3.10"]
    condition: all
    rules:
      -

  - id: 21023
    title: "Only enable NFS client processes if absolutely necessary"
    description: "Again, unless there is a significant need for this system to acquire data via NFS, administrators should disable NFS-related services.  Note that other file transfer schemes (such as rdist via SSH) can often be more secure than NFS for certain applications, although again the use of secure RPC or Kerberos can significantly improve NFS security. Also note that if the machine will be an NFS client, then the rpcbind process must be running (see Item 3.12 below)."
    rationale: "This system must access file systems from remote servers via NFS."
    remediation: "Perform the following: ch_rc -a -p NFS_CLIENT=1 /etc/rc.config.d/nfsconf"
    compliance:
      - ["1.3.11"]
    condition: all
    rules:
      -

  - id: 21024
    title: "Only enable RPC-based services if absolutely necessary"
    description: "RPC-based services typically use very weak or non-existent authentication and yet may share very sensitive information.  Unless one of the services listed above is required on this machine, it is best to disable RPC-based tools completely.  If you are unsure whether or not a particular third-party application requires RPC services, consult with the application vendor. Note that disabling this service by renaming the startup file may not survive the install of RPC-related patches."
    rationale: "RPC-based services are used such as: This machine is an NFS client or server  This machine is an NIS (YP) or NIS+ client or server  This machine runs a GUI or GUI-based administration tool  The machine runs a third-party software application which is dependent on RPC support (example: FlexLM License managers)"
    remediation: "Perform the following for 11.31 and later: ch_rc -a -p NFS_CORE=1 /etc/rc.config.d/nfsconf     For 11.23 and prior: mv -f /sbin/rc2.d/.NOS400nfs.core /sbin/rc2.d/400nfs.core"
    compliance:
      - ["1.3.12"]
    condition: all
    rules:
      -

  - id: 21025
    title: "Only enable Web server if absolutely necessary"
    description: "Even if this machine is a Web server, the local site may choose not to use the Web server provided with HP-UX in favor of a locally developed and supported Web environment. If the machine is a Web server, the administrator is encouraged to search the Web for additional documentation on Web server security.  A good starting point is http://httpd.apache.org/docs-2.0/misc/security_tips.html."
    rationale: "There is a mission-critical reason why this system must run a Web server. "
    remediation: "Perform the following: ch_rc -a -p NS_FTRACK=1           /etc/rc.config.d/ns-ftrack   ch_rc -a -p APACHE_START=1        /etc/rc.config.d/apacheconf    ch_rc -a -p HPWS_APACHE32_START=1 /etc/rc.config.d/hpws_apache32conf   ch_rc -a -p HPWS_TOMCAT_START=1   /etc/rc.config.d/hpws_tomcatconf   ch_rc -a -p NS_FTRACK=1           /etc/rc.config.d/ns-ftrack   ch_rc -a -p HPWS_WEBMIN_START=1   /etc/rc.config.d/hpws_webminconf "
    compliance:
      - ["1.3.13"]
    condition: all
    rules:
      -

  - id: 21026
    title: "Only enable BIND DNS server if absolutely necessary"
    description: "The BIND DNS server, or named, maps IP addresses to hostnames across the Internet and supplies these services to other hosts on the local local network. Though it has been widely implemented, BIND has a long history of security flaws, especially in the BIND 8.x release tree generally shipped with HP-UX 11.x systems. Therefore, if you are going to run BIND, you should strongly consider moving to the BIND 9.x release-tree. HP has supported BIND 9 packages available from http://software.hp.com/portal/swdepot/displayProductInfo.do?productNumber=BIND9.2. Or it is available directly from the Internet Software Consortium (the developers of BIND), whose website is at http://www.isc.org."
    rationale: "There exists a mission-critical reason why this system must run a DNS server."
    remediation: "Perform the following: 11.23 and prior: ch_rc -a -p NAMED=1 /etc/rc.config.d/namesvrs 11.31 and later: ch_rc -a -p NAMED=1 /etc/rc.config.d/namesvrs_dns"
    compliance:
      - ["1.3.14"]
    condition: all
    rules:
      -
