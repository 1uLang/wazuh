{
  "order": 0,
  "index_patterns": ["wazuh-alerts-3.x-*"],
  "settings": {
    "index.refresh_interval": "5s",
    "index.number_of_shards": "3",
    "index.number_of_replicas": "0",
    "index.auto_expand_replicas": "0-1",
    "index.mapping.total_fields.limit": 2000
  },
  "mappings": {
    "dynamic_templates": [
      {
        "string_as_keyword": {
          "match_mapping_type": "string",
          "mapping": {
            "type": "keyword"
          }
        }
      }
    ],
    "properties": {
      "@timestamp": {
        "type": "date"
      },
      "timestamp": {
        "type": "date",
        "format": "date_optional_time||epoch_millis"
      },
      "@version": {
        "type": "text"
      },
      "full_log": {
        "enabled": false,
        "type": "object"
      },
      "previous_log": {
        "type": "text"
      },
      "GeoLocation": {
        "properties": {
          "area_code": {
            "type": "long"
          },
          "continent_code": {
            "type": "text"
          },
          "coordinates": {
            "type": "double"
          },
          "country_code2": {
            "type": "text"
          },
          "country_code3": {
            "type": "text"
          },
          "dma_code": {
            "type": "long"
          },
          "latitude": {
            "type": "double"
          },
          "location": {
            "type": "geo_point"
          },
          "longitude": {
            "type": "double"
          },
          "timezone": {
            "type": "text"
          }
        }
      },
      "syscheck": {
        "properties": {
          "mtime_after": {
            "type": "date",
            "format": "dateOptionalTime"
          },
          "mtime_before": {
            "type": "date",
            "format": "dateOptionalTime"
          },
          "size_before": {
            "type": "long"
          },
          "size_after": {
            "type": "long"
          }
        }
      },
      "message": {
        "type": "text"
      },
      "rule": {
        "properties": {
          "level": {
            "type": "long"
          },
          "frequency": {
            "type": "long"
          },
          "firedtimes": {
            "type": "long"
          }
        }
      },
      "decoder": {
        "properties": {
          "fts": {
            "type": "long"
          },
          "accumulate": {
            "type": "long"
          }
        }
      },
      "data": {
        "properties": {
          "oscap": {
            "properties": {
              "check.description": {
                "type": "text"
              },
              "check.rationale": {
                "type": "text"
              },
              "check.references": {
                "type": "text"
              },
              "check.identifiers": {
                "type": "text"
              },
              "scan.score": {
                "type": "double"
              },
              "scan.return_code": {
                "type": "long"
              }
            }
          },
          "aws": {
            "properties": {
              "bytes": {
                "type": "long"
              },
              "dstaddr": {
                "type": "ip"
              },
              "srcaddr": {
                "type": "ip"
              },
              "end": {
                "type": "date"
              },
              "start": {
                "type": "date"
              },
              "source_ip_address": {
                "type": "ip"
              },
              "resource.instanceDetails.networkInterfaces": {
                "properties": {
                  "privateIpAddress": {
                    "type": "ip"
                  },
                  "publicIp": {
                    "type": "ip"
                  }
                }
              },
              "service": {
                "properties": {
                  "count": {
                    "type": "long"
                  },
                  "action.networkConnectionAction.remoteIpDetails": {
                    "properties": {
                      "ipAddressV4": {
                        "type": "ip"
                      },
                      "geoLocation": {
                        "type": "geo_point"
                      }
                    }
                  }
                }
              }
            }
          },
          "netinfo": {
            "properties": {
              "iface": {
                "properties": {
                  "mtu": {
                    "type": "long"
                  },
                  "tx_bytes": {
                    "type": "long"
                  },
                  "rx_bytes": {
                    "type": "long"
                  },
                  "tx_errors": {
                    "type": "long"
                  },
                  "rx_errors": {
                    "type": "long"
                  },
                  "tx_dropped": {
                    "type": "long"
                  },
                  "rx_dropped": {
                    "type": "long"
                  },
                  "tx_packets": {
                    "type": "long"
                  },
                  "rx_packets": {
                    "type": "long"
                  },
                  "ipv4": {
                    "properties": {
                      "metric": {
                        "type": "long"
                      }
                    }
                  },
                  "ipv6": {
                    "properties": {
                      "metric": {
                        "type": "long"
                      }
                    }
                  }
                }
              }
            }
          },
          "port": {
            "properties": {
              "local_ip": {
                "type": "ip"
              },
              "local_port": {
                "type": "long"
              },
              "remote_ip": {
                "type": "ip"
              },
              "remote_port": {
                "type": "long"
              },
              "tx_queue": {
                "type": "long"
              },
              "rx_queue": {
                "type": "long"
              },
              "inode": {
                "type": "long"
              },
              "pid": {
                "type": "long"
              }
            }
          },
          "hardware": {
            "properties": {
              "cpu_cores": {
                "type": "long"
              },
              "cpu_mhz": {
                "type": "double"
              },
              "ram_total": {
                "type": "long"
              },
              "ram_free": {
                "type": "long"
              },
              "ram_usage": {
                "type": "long"
              }
            }
          },
          "program": {
            "properties": {
              "size": {
                "type": "long"
              }
            }
          },
          "process": {
            "properties": {
              "pid": {
                "type": "long"
              },
              "ppid": {
                "type": "long"
              },
              "utime": {
                "type": "long"
              },
              "stime": {
                "type": "long"
              },
              "priority": {
                "type": "long"
              },
              "nice": {
                "type": "long"
              },
              "size": {
                "type": "long"
              },
              "vm_size": {
                "type": "long"
              },
              "resident": {
                "type": "long"
              },
              "share": {
                "type": "long"
              },
              "start_time": {
                "type": "long"
              },
              "pgrp": {
                "type": "long"
              },
              "session": {
                "type": "long"
              },
              "nlwp": {
                "type": "long"
              },
              "tgid": {
                "type": "long"
              },
              "tty": {
                "type": "long"
              },
              "processor": {
                "type": "long"
              }
            }
          },
          "sca": {
            "properties": {
              "passed": {
                "type": "integer"
              },
              "failed": {
                "type": "integer"
              },
              "score": {
                "type": "long"
              }
            }
          }
        }
      },
      "type": {
        "type": "text"
      }
    }
  }
}
